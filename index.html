
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Society Ticker</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: 'Courier New', Courier, monospace;
      overflow: hidden;
      margin: 0;
    }
    .ticker-wrap {
      position: fixed;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
    }
    .ticker {
      display: inline-block;
      white-space: nowrap;
      animation: ticker 30s linear infinite;
      font-size: 3em;
    }
    .item {
      display: inline-block;
      margin-right: 60px;
    }
    .up {
      color: #00ff00;
    }
    .down {
      color: #ff4444;
    }
    @keyframes ticker {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
  </style>
</head>
<body>
  <div class="ticker-wrap">
    <div class="ticker" id="ticker">
      Loading society stats...
    </div>
  </div>

<script>
  const endpoint = "https://script.google.com/macros/s/AKfycbzNzwthmRCgvlE5nqmMO1i9QH44Cw26XQ_lk-7yjBwtsgtpIRNpQTZYpW8PwZL6qZCBNw/exec";

  async function fetchData() {
    try {
      const res = await fetch(endpoint);
      const data = await res.json();
      updateTicker(data);
    } catch (err) {
      console.error('Error fetching data:', err);
      document.getElementById("ticker").textContent = "Error fetching data. Please check your connection.";
    }
  }

  function updateTicker(data) {
    const ticker = document.getElementById("ticker");
    ticker.innerHTML = "";

    data.forEach((society) => {
      const item = document.createElement("div");
      item.className = "item " + (society["Up/Down"] === "up" ? "up" : "down");
      item.textContent = `[ ${society["Society Name"]} ] RM ${Number(society["Total Members"]).toFixed(2)} ${society["Up/Down"] === "up" ? "▲" : "▼"}`;
      ticker.appendChild(item);
    });
  }

  fetchData();
  setInterval(fetchData, 10000); // Refresh every 10 seconds
</script>

    async function fetchData() {
      try {
        const res = await fetch(endpoint);
        const data = await res.json();
        updateTicker(data);
      } catch (err) {
        console.error('Error fetching data:', err);
        document.getElementById("ticker").textContent = "Error fetching data. Please check your connection.";
      }
    }

    function updateTicker(data) {
      const ticker = document.getElementById("ticker");
      ticker.innerHTML = "";

      data.forEach((society) => {
        const item = document.createElement("div");
        item.className = "item " + (society.trend === "up" ? "up" : "down");
        item.textContent = `[ ${society["Society Name"]} ] RM ${Number(society["Total Members"]).toFixed(2)} ${society["Up/Down"] === "up" ? "▲" : "▼"}`;
item.className = "item " + (society["Up/Down"] === "up" ? "up" : "down");
        ticker.appendChild(item);
      });
    }

    fetchData();
    setInterval(fetchData, 10000); // Refresh every 10 seconds
  </script>
</body>
</html>
